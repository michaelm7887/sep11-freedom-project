<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Spaceship Shooter</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; }
    canvas { display: block; margin: auto; }
  </style>
</head>
<body>
  <script>
    const config = {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      physics: {
        default: 'arcade',
        arcade: {
          debug: false
        }
      },
      scene: {
        preload,
        create,
        update
      }
    };

    let player;
    let cursors;
    let bullets;
    let enemies;
    let lastFired = 0;
    let playerHealth = 3;
    let healthText;
    let gameOverText;

    const game = new Phaser.Game(config);

    function preload() {
      this.load.image('player', 'https://labs.phaser.io/assets/sprites/player.png');
      this.load.image('bullet', 'https://labs.phaser.io/assets/sprites/bullet.png');
      this.load.image('enemy', 'https://labs.phaser.io/assets/sprites/ufo.png');
    }

    function create() {
      player = this.physics.add.image(400, 550, 'player').setScale(1.5).setCollideWorldBounds(true);
      cursors = this.input.keyboard.createCursorKeys();
      bullets = this.physics.add.group({ classType: Phaser.Physics.Arcade.Image, runChildUpdate: true });
      enemies = this.physics.add.group();
      // Show health
healthText = this.add.text(16, 16, 'Health: 3', {
  fontSize: '24px',
  fill: '#fff'
});


this.physics.add.overlap(player, enemies, (player, enemy) => {
  enemy.destroy();
  playerHealth--;
  healthText.setText('Health: ' + playerHealth);

  if (playerHealth <= 0) {
    this.physics.pause(); // Stop the game
    player.setTint(0xff0000); // Red tint for damage

    // Create the 'Game Over' text
    if (!gameOverText) {
      gameOverText = this.add.text(400, 300, 'GAME OVER', {
        fontSize: '64px',
        fill: '#ff0000',
        fontStyle: 'bold'
      }).setOrigin(0.5); // Center the text
    }
  }
});



      // Enemy spawner
      this.time.addEvent({
        delay: 1000,
        callback: () => {
          const x = Phaser.Math.Between(50, 750);
          const enemy = enemies.create(x, 0, 'enemy');
          enemy.setVelocityY(100);
        },
        loop: true
      });

      // Bullet/enemy collision
      this.physics.add.overlap(bullets, enemies, (bullet, enemy) => {
        bullet.destroy();
        enemy.destroy();
      });
    }

    function update(time, delta) {
      if (cursors.left.isDown) {
        player.setVelocityX(-300);
      } else if (cursors.right.isDown) {
        player.setVelocityX(300);
      } else {
        player.setVelocityX(0);
      }

      if (cursors.space.isDown && time > lastFired) {
        const bullet = bullets.get(player.x, player.y - 20, 'bullet');
        if (bullet) {
          bullet.setActive(true);
          bullet.setVisible(true);
          bullet.body.velocity.y = -400;
          lastFired = time + 300;
        }
      }

      bullets.children.each(bullet => {
        if (bullet.active && bullet.y < 0) {
          bullet.setActive(false);
          bullet.setVisible(false);
        }
      }, this);
    }
  </script>
</body>
</html>
